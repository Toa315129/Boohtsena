<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Photo Booth @saphasena68</title>
<style>
  :root{
    --booth-red: #d62828;
    --booth-red-dark: #a31d1d;
    --accent-yellow: #ffd54f;
    --card-bg: #ffffff;
    --shadow: 0 8px 20px rgba(0,0,0,0.25);
    --radius: 18px;
    --text: #fff;
  }
  html,body{
    height:100%;
    margin:0;
    font-family:"Kanit","Inter",system-ui,sans-serif;
    background:linear-gradient(180deg,#ffe5e5,#fff0f0);
  }
  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:24px;
    box-sizing:border-box;
  }
  .booth{
    width:380px;
    background:var(--booth-red);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding:16px;
    border:6px solid var(--booth-red-dark);
    position:relative;
  }
  .title{
    text-align:center;
    font-weight:700;
    font-size:20px;
    margin-bottom:10px;
    color:var(--text);
    letter-spacing:1px;
  }
  .frame-preview{
    width:100%;
    background:#000;
    border-radius:12px;
    padding:8px;
    box-sizing:border-box;
    position:relative;
    overflow:hidden;
    aspect-ratio:2/3;
    display:flex;
    align-items:center;
    justify-content:center;
    border:4px solid var(--booth-red-dark);
  }
  #video{
    width:92%;
    border-radius:8px;
    background:black;
    transform:scaleX(-1);
  }
  .controls{
    margin-top:12px;
    display:flex;
    gap:8px;
    justify-content:center;
    flex-wrap:wrap;
  }
  button{
    background:var(--accent-yellow);
    border:0;
    padding:8px 12px;
    border-radius:10px;
    font-weight:700;
    cursor:pointer;
    box-shadow:0 4px 10px rgba(0,0,0,0.15);
  }
  button.secondary{
    background:#fff;
    color:#a31d1d;
    font-weight:600;
  }
  .thumbs{
    margin-top:12px;
    display:flex;
    flex-direction:column;
    gap:8px;
    align-items:center;
  }
  .thumb-row{
    width:92%;
    display:flex;
    gap:8px;
    justify-content:space-between;
  }
  .thumb{
    width:30%;
    background:white;
    border-radius:8px;
    overflow:hidden;
    height:80px;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow:0 6px 14px rgba(10,30,60,0.08);
  }
  .thumb img{width:100%;height:100%;object-fit:cover;border-radius:8px;}
  .countdown{
    position:absolute;inset:0;
    display:flex;align-items:center;justify-content:center;
    font-size:64px;font-weight:900;
    color:rgba(255,255,255,0.95);
    text-shadow:0 6px 18px rgba(0,0,0,0.5);
    pointer-events:none;
  }
  .next-msg{
    position:absolute;bottom:10px;left:50%;
    transform:translateX(-50%);
    background:#ffd54f;color:#a31d1d;
    padding:4px 10px;border-radius:12px;font-weight:600;display:none;
  }
  .small-note{
    font-size:12px;color:#fff;text-align:center;margin-top:8px;
  }
  .actions{
    display:flex;gap:8px;justify-content:center;margin-top:8px;flex-wrap:wrap;
  }
  .download-btn{
    background:#4d9cff;color:white;padding:8px 10px;border-radius:10px;border:0;font-weight:700;
  }
  .print-btn{
    background:#43a047;color:white;padding:8px 10px;border-radius:10px;border:0;font-weight:700;
  }
  .star{position:absolute;fill:#ffd54f;opacity:0.8;}
  @media (min-width:700px){.booth{width:480px;}}
</style>
</head>
<body>
<div class="wrap">
  <div class="booth" role="application" aria-label="photo booth">
    <div class="title">üì∏ Photo Booth @saphasena68</div>

    <div class="frame-preview" id="framePreview">
      <video id="video" autoplay playsinline></video>
      <div class="countdown" id="countdown" style="display:none;"></div>
      <div class="next-msg" id="nextMsg">Next ‚û°Ô∏è</div>
    </div>

    <div class="controls">
      <button id="switchBtn">‡∏™‡∏•‡∏±‡∏ö‡∏Å‡∏•‡πâ‡∏≠‡∏á</button>
      <button id="startBtn">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ñ‡πà‡∏≤‡∏¢ (3 ‡∏£‡∏π‡∏õ)</button>
      <button id="retakeBtn" class="secondary">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    </div>

    <div class="thumbs" aria-live="polite">
      <div class="thumb-row">
        <div class="thumb" id="t1"><span style="opacity:0.45;">1</span></div>
        <div class="thumb" id="t2"><span style="opacity:0.45;">2</span></div>
        <div class="thumb" id="t3"><span style="opacity:0.45;">3</span></div>
      </div>
      <div class="small-note">‡∏ñ‡πà‡∏≤‡∏¢‡∏Ñ‡∏£‡∏ö 3 ‡∏ä‡πà‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å/‡∏û‡∏¥‡∏°‡∏û‡πå‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</div>
      <div class="actions">
        <button id="downloadBtn" class="download-btn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î 4x6</button>
        <button id="printBtn" class="print-btn">‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏π‡∏õ</button>
      </div>
    </div>
  </div>
</div>

<audio id="snapSound" src="https://www.soundjay.com/mechanical/camera-shutter-click-01.mp3" preload="auto"></audio>

<script>
(async function(){
  const video=document.getElementById('video');
  const startBtn=document.getElementById('startBtn');
  const retakeBtn=document.getElementById('retakeBtn');
  const switchBtn=document.getElementById('switchBtn');
  const countdownEl=document.getElementById('countdown');
  const nextMsg=document.getElementById('nextMsg');
  const thumbs=[document.getElementById('t1'),document.getElementById('t2'),document.getElementById('t3')];
  const snapSound=document.getElementById('snapSound');
  let captures=[null,null,null];
  let currentFacing="user";
  let stream;

  async function startCamera(){
    if(stream){stream.getTracks().forEach(t=>t.stop());}
    try{
      stream=await navigator.mediaDevices.getUserMedia({video:{facingMode:currentFacing},audio:false});
      video.srcObject=stream;
      await video.play();
    }catch(err){alert('‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');console.error(err);}
  }
  await startCamera();

  function showCountdown(n){countdownEl.style.display='flex';countdownEl.textContent=n;}
  function hideCountdown(){countdownEl.style.display='none';}
  function showNextMsg(){nextMsg.style.display='block';setTimeout(()=>{nextMsg.style.display='none';},1000);}

  function captureFrame(){
    const vw=video.videoWidth,vh=video.videoHeight;
    const canvas=document.createElement('canvas');
    canvas.width=vw;canvas.height=vh;
    const ctx=canvas.getContext('2d');
    ctx.translate(vw,0);ctx.scale(-1,1);
    ctx.drawImage(video,0,0,vw,vh);
    return canvas.toDataURL('image/png');
  }

  async function takeThreeShots(){
    startBtn.disabled=true;retakeBtn.disabled=true;
    captures=[null,null,null];thumbs.forEach((el,i)=>el.innerHTML=`<span style="opacity:0.45;">${i+1}</span>`);
    for(let i=0;i<3;i++){
      for(let s=3;s>=1;s--){showCountdown(s);await new Promise(r=>setTimeout(r,800));}
      hideCountdown();
      const flash=document.createElement('div');
      flash.style.position='absolute';flash.style.inset='0';flash.style.background='white';flash.style.opacity='0.95';flash.style.transition='opacity 170ms';document.body.appendChild(flash);
      setTimeout(()=>{flash.style.opacity='0';setTimeout(()=>flash.remove(),200);},120);
      snapSound.play();
      const data=captureFrame();captures[i]=data;
      thumbs[i].innerHTML=`<img src="${data}" alt="thumb${i+1}">`;
      if(i<2)showNextMsg();
      await new Promise(r=>setTimeout(r,500));
    }
    startBtn.disabled=false;retakeBtn.disabled=false;
  }

  startBtn.addEventListener('click',takeThreeShots);
  retakeBtn.addEventListener('click',()=>{captures=[null,null,null];thumbs.forEach((el,i)=>el.innerHTML=`<span style="opacity:0.45;">${i+1}</span>`);});
  switchBtn.addEventListener('click',()=>{currentFacing=(currentFacing==="user")?"environment":"user";startCamera();});

  // ‡∏î‡∏≤‡∏ß‡πÄ‡∏•‡πá‡∏Å ‡πÜ ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏ô‡∏Å‡∏£‡∏≠‡∏ö
  const frame=document.getElementById('framePreview');
  for(let i=0;i<12;i++){
    const star=document.createElementNS("http://www.w3.org/2000/svg","svg");
    const size=Math.random()*8+5;
    star.setAttribute("width",size);
    star.setAttribute("height",size);
    star.classList.add("star");
    star.style.left=Math.random()*90+"%";
    star.style.top=Math.random()*90+"%";
    star.style.position="absolute";
    star.innerHTML='<circle cx="5" cy="5" r="4" fill="#ffd54f"/>';
    frame.appendChild(star);
  }

  // ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î + ‡∏û‡∏¥‡∏°‡∏û‡πå
  function roundRect(ctx,x,y,w,h,r,fill,stroke){
    ctx.beginPath();
    ctx.moveTo(x+r,y);ctx.arcTo(x+w,y,x+w,y+h,r);
    ctx.arcTo(x+w,y+h,x,y+h,r);ctx.arcTo(x,y+h,x,y,r);
    ctx.arcTo(x,y,x+w,y,r);ctx.closePath();
    if(fill)ctx.fill();if(stroke)ctx.stroke();
  }
  function drawImageInFrame(ctx,imgSrc,x,y,w,h,r){
    return new Promise((resolve,reject)=>{
      const img=new Image();
      img.onload=function(){
        ctx.save();roundRect(ctx,x,y,w,h,r,false,false);ctx.clip();
        const ratio=Math.max(w/img.width,h/img.height);
        const nw=img.width*ratio,nh=img.height*ratio;
        const dx=x+(w-nw)/2,dy=y+(h-nh)/2;
        ctx.drawImage(img,dx,dy,nw,nh);ctx.restore();resolve();
      };
      img.onerror=reject;img.src=imgSrc;
    });
  }
  async function generateCanvas(){
    const finalW=1200,finalH=1800;
    const canvas=document.createElement('canvas');canvas.width=finalW;canvas.height=finalH;
    const ctx=canvas.getContext('2d');
    ctx.fillStyle='#d62828';ctx.fillRect(0,0,finalW,finalH);

    const margin=60;const innerX=margin;const innerY=margin+60;
    const innerW=finalW-margin*2;const innerH=finalH-innerY-margin;
    ctx.fillStyle='#ffffff';roundRect(ctx,innerX,innerY,innerW,innerH,20,true,false);

    ctx.fillStyle='#a31d1d';ctx.font='bold 48px "Kanit",sans-serif';ctx.textAlign='center';ctx.textBaseline='middle';
    ctx.fillText('Photo Booth @saphasena68',finalW/2,margin+28);

    const gutter=18;const photoX=innerX+28;const photoW=innerW-56;
    const singleH=Math.floor((innerH-gutter*2-56)/3);
    let y=innerY+28;
    for(let i=0;i<3;i++){
      ctx.fillStyle='#fbe9e7';roundRect(ctx,photoX,y,photoW,singleH,12,true,false);
      if(captures[i]){await drawImageInFrame(ctx,captures[i],photoX,y,photoW,singleH,12);}
      ctx.strokeStyle='#d62828';ctx.lineWidth=8;roundRect(ctx,photoX+6,y+6,photoW-12,singleH-12,9,false,true);
      y+=singleH+gutter;
    }
    ctx.fillStyle='#a31d1d';ctx.font='18px sans-serif';ctx.fillText('‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡∏ô‡∏≤‡∏î 4x6 ‡∏ô‡∏¥‡πâ‡∏ß ‚Ä¢ Photo Booth',finalW/2,finalH-30);
    return canvas;
  }
  document.getElementById('downloadBtn').addEventListener('click',async ()=>{
    if(!captures.some(c=>c)){alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û');return;}
    const canvas=await generateCanvas();
    const a=document.createElement('a');a.href=canvas.toDataURL('image/png');a.download='photobooth_red_4x6.png';a.click();
  });
  document.getElementById('printBtn').addEventListener('click',async ()=>{
    if(!captures.some(c=>c)){alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û');return;}
    const canvas=await generateCanvas();
    const win=window.open('','PrintPhoto');
    win.document.write('<img src="'+canvas.toDataURL('image/png')+'" style="width:100%">');
    win.print();
  });
})();
</script>
</body>
</html>
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Photo Booth</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background: #111; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ï‡∏π‡πâ */
      font-family: Arial, sans-serif;
      color: white;
    }

    .booth {
      position: relative;
      width: 400px;
      height: 600px;
      background: #000;
      border: 8px solid #444;
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    video {
      width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .countdown {
      position: absolute;
      font-size: 60px;
      font-weight: bold;
      color: white;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      display: none;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #ff4d4d;
      color: white;
      font-size: 16px;
      cursor: pointer;
    }

    /* ‡∏Å‡∏£‡∏≠‡∏ö‡πÇ‡∏û‡∏•‡∏≤‡∏£‡∏≠‡∏¢‡∏î‡πå */
    .polaroid {
      margin-top: 20px;
      width: 300px;
      background: white;
      padding: 15px 10px 40px 10px;
      box-shadow: 2px 2px 8px rgba(0,0,0,0.5);
      text-align: center;
    }

    .polaroid img {
      width: 100%;
      display: block;
      margin-bottom: 8px;
    }

    .caption {
      font-size: 18px;
      font-weight: bold;
      color: red;
    }
  </style>
</head>
<body>
  <div class="booth">
    <video id="video" autoplay></video>
    <div class="countdown" id="countdown">3</div>
    <button id="startBtn">‡∏ñ‡πà‡∏≤‡∏¢‡∏£‡∏π‡∏õ</button>
  </div>

  <!-- ‡∏ó‡∏µ‡πà‡πÇ‡∏ä‡∏ß‡πå‡∏£‡∏π‡∏õ‡πÇ‡∏û‡∏•‡∏≤‡∏£‡∏≠‡∏¢‡∏î‡πå -->
  <div id="output"></div>

  <script>
    const video = document.getElementById('video');
    const countdown = document.getElementById('countdown');
    const startBtn = document.getElementById('startBtn');
    const output = document.getElementById('output');

    // ‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏•‡πâ‡∏≠‡∏á
    navigator.mediaDevices.getUserMedia({ video: true }).then(stream => {
      video.srcObject = stream;
    });

    async function takePhoto() {
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const ctx = canvas.getContext('2d');
      ctx.drawImage(video, 0, 0);
      return canvas.toDataURL('image/png');
    }

    async function startShooting() {
      let photos = [];

      for (let i = 3; i > 0; i--) {
        countdown.style.display = 'block';
        countdown.textContent = i;
        await new Promise(r => setTimeout(r, 1000));
      }
      countdown.style.display = 'none';

      // ‡∏ñ‡πà‡∏≤‡∏¢ 3 ‡∏£‡∏π‡∏õ
      for (let i = 0; i < 3; i++) {
        photos.push(await takePhoto());
        new Audio("https://actions.google.com/sounds/v1/camera/camera_click.ogg").play();
        await new Promise(r => setTimeout(r, 1500));
      }

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏û‡∏•‡∏≤‡∏£‡∏≠‡∏¢‡∏î‡πå
      const polaroid = document.createElement('div');
      polaroid.className = 'polaroid';

      photos.forEach(p => {
        const img = document.createElement('img');
        img.src = p;
        polaroid.appendChild(img);
      });

      const caption = document.createElement('div');
      caption.className = 'caption';
      caption.textContent = 'Photo Booth @saphasena68';
      polaroid.appendChild(caption);

      output.innerHTML = '';
      output.appendChild(polaroid);
    }

    startBtn.addEventListener('click', startShooting);
  </script>
</body>
</html>
